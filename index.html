<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DeerghAyu Seniors Program - Project Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
  /* ══ TAB NAVIGATION ══════════════════════════════════════════ */
  .tab-nav {
    display: flex;
    gap: 0;
    background: #1B3A6B;
    padding: 0 32px;
    border-bottom: 3px solid #60A5FA;
  }
  .tab-btn {
    padding: 12px 28px;
    background: transparent;
    border: none;
    color: rgba(255,255,255,0.6);
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    font-family: 'Inter', sans-serif;
    border-bottom: 3px solid transparent;
    margin-bottom: -3px;
    transition: all 0.2s;
  }
  .tab-btn:hover {
    color: rgba(255,255,255,0.9);
    background: rgba(255,255,255,0.05);
  }
  .tab-btn.active {
    color: #ffffff;
    font-weight: 700;
    border-bottom: 3px solid #60A5FA;
    background: rgba(96,165,250,0.1);
  }
  .tab-content {
    display: block;
  }
  @media print {
    .tab-nav { display: none !important; }
  }

  /* ══ GANTT CHART STYLES ══════════════════════════════════════ */
  * { margin:0; padding:0; box-sizing:border-box; }

  body {
    background: #F4F6F9;
    font-family: 'Inter', sans-serif;
    font-size: 12px;
    color: #1A1A2E;
  }

  /* ── PAGE WRAPPER ── */
  .page {
    background: #fff;
    margin: 20px auto;
    width: 100%;
    max-width: 100%;
    border: 1px solid #DDE2EC;
    border-radius: 6px;
    overflow: hidden;
    box-shadow: 0 2px 12px rgba(0,0,0,0.08);
  }

  /* ── HEADER ── */
  .header {
    background: #1B3A6B;
    padding: 20px 28px 16px;
    color: #fff;
  }
  .header-top {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    flex-wrap: wrap;
    gap: 12px;
  }
  .header h1 {
    font-size: 20px;
    font-weight: 700;
    letter-spacing: -0.2px;
  }
  .header .tagline {
    font-size: 11px;
    color: rgba(255,255,255,0.65);
    margin-top: 3px;
    font-weight: 300;
  }
  .header-meta {
    display: flex;
    gap: 24px;
    flex-wrap: wrap;
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid rgba(255,255,255,0.12);
  }
  .meta-item { font-size: 11px; color: rgba(255,255,255,0.65); }
  .meta-item span { color: #fff; font-weight: 500; }

  /* ── PHASE LEGEND ── */
  .legend-bar {
    display: flex;
    gap: 6px;
    padding: 10px 28px;
    background: #F8FAFD;
    border-bottom: 1px solid #DDE2EC;
    flex-wrap: wrap;
    align-items: center;
  }
  .legend-label { font-size: 10px; color: #666; font-weight: 600; margin-right: 4px; text-transform:uppercase; letter-spacing:0.5px; }
  .leg {
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: 10px;
    color: #444;
    padding: 3px 9px;
    border-radius: 3px;
    border: 1px solid;
  }
  .leg-dot { width:9px; height:9px; border-radius:2px; }
  .leg-milestone { width:8px; height:8px; transform:rotate(45deg); background:#C0392B; }

  /* ── GANTT TABLE ── */
  .gantt-scroll { overflow-x: auto; }

  table {
    border-collapse: collapse;
    width: 100%;
    min-width: 1200px;
  }

  /* Column widths */
  .col-id    { width: 52px; }
  .col-task  { width: 240px; }
  .col-owner { width: 90px; }
  .col-start { width: 78px; }
  .col-end   { width: 78px; }
  .col-dur   { width: 58px; }
  .col-prog  { width: 80px; }
  /* week columns are set dynamically */

  /* Header rows */
  thead tr.month-row th {
    background: #1B3A6B;
    color: #fff;
    font-size: 11px;
    font-weight: 600;
    text-align: center;
    padding: 6px 4px;
    border: 1px solid #2A4E8A;
  }
  thead tr.week-row th {
    background: #EEF2FA;
    color: #444;
    font-size: 10px;
    font-weight: 600;
    text-align: center;
    padding: 5px 2px;
    border: 1px solid #DDE2EC;
    white-space: nowrap;
  }
  thead tr.col-header th {
    background: #2A4E8A;
    color: #fff;
    font-size: 10px;
    font-weight: 600;
    padding: 7px 8px;
    border: 1px solid #3A5E9A;
    text-transform: uppercase;
    letter-spacing: 0.4px;
    white-space: nowrap;
  }

  /* Phase rows */
  tr.phase-row td {
    font-size: 12px;
    font-weight: 700;
    padding: 8px 10px;
    border-bottom: 1px solid #DDE2EC;
  }
  tr.phase-row td.phase-label {
    display: flex;
    align-items: center;
    gap: 7px;
  }
  .phase-pill {
    font-size: 9px;
    font-weight: 600;
    padding: 2px 7px;
    border-radius: 3px;
    color: #fff;
  }

  /* Task rows */
  tr.task-row td {
    padding: 5px 8px;
    border: 1px solid #EEF0F5;
    vertical-align: middle;
    font-size: 11px;
    color: #333;
  }
  tr.task-row:hover td { background: #F8FAFD; }
  tr.task-row.milestone-row td { background: #FFF8F8; }

  /* Fixed left columns */
  td.td-id {
    font-size: 10px;
    color: #888;
    font-weight: 500;
    text-align: center;
    white-space: nowrap;
  }
  td.td-task {
    font-size: 11px;
    color: #1A1A2E;
    padding-left: 20px !important;
    white-space: nowrap;
  }
  td.td-task.is-milestone {
    color: #C0392B;
    font-weight: 600;
    padding-left: 16px !important;
  }
  .milestone-icon {
    display: inline-block;
    width: 8px; height: 8px;
    background: #C0392B;
    transform: rotate(45deg);
    margin-right: 6px;
    vertical-align: middle;
  }
  td.td-owner {
    font-size: 10px;
    color: #555;
    white-space: nowrap;
  }
  .owner-chip {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 2px 7px;
    border-radius: 10px;
    font-size: 10px;
    font-weight: 500;
    color: #fff;
  }
  td.td-date {
    font-size: 10px;
    color: #555;
    text-align: center;
    white-space: nowrap;
  }
  td.td-dur {
    font-size: 10px;
    color: #777;
    text-align: center;
  }

  /* Week cells in task rows */
  td.week-cell {
    padding: 3px 1px;
    border: 1px solid #F0F0F5;
    position: relative;
    min-width: 28px;
    height: 34px;
    vertical-align: middle;
  }
  td.week-cell.alt { background: #FAFBFE; }
  td.week-cell.milestone-week { background: #FFF5F5; }

  /* Gantt bars */
  .bar {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    height: 18px;
    border-radius: 3px;
    display: flex;
    align-items: center;
    padding: 0 6px;
    font-size: 8.5px;
    font-weight: 600;
    color: rgba(255,255,255,0.95);
    white-space: nowrap;
    overflow: hidden;
    left: 0;
    right: 0;
    box-shadow: 0 1px 3px rgba(0,0,0,0.15);
  }
  .bar.critical {
    outline: 1.5px solid #C0392B;
    outline-offset: 1px;
  }

  /* Milestone diamond */
  .diamond {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%,-50%) rotate(45deg);
    width: 13px; height: 13px;
    background: #C0392B;
    box-shadow: 0 0 6px rgba(192,57,43,0.4);
  }

  /* Today column highlight */
  td.today-col { background: rgba(27,90,180,0.05) !important; border-color: #1B5AB4 !important; }
  .today-header { background: #1B5AB4 !important; color: #fff !important; }

  /* Footer */
  .footer {
    padding: 14px 28px;
    background: #F8FAFD;
    border-top: 1px solid #DDE2EC;
    display: flex;
    gap: 36px;
    flex-wrap: wrap;
    align-items: flex-start;
    page-break-before: avoid;
    break-before: avoid;
  }

  /* Export button & dropdown */
  .export-wrapper {
    position: relative;
    display: inline-block;
    margin-top: 8px;
  }
  .export-btn {
    background: #fff;
    color: #1B3A6B;
    border: none;
    padding: 8px 16px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    transition: all 0.2s;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  .export-btn:hover {
    background: #EEF4FF;
    transform: translateY(-1px);
    box-shadow: 0 3px 6px rgba(0,0,0,0.15);
  }
  .export-btn svg {
    width: 14px;
    height: 14px;
  }
  .export-dropdown {
    display: none;
    position: absolute;
    right: 0;
    top: 100%;
    margin-top: 4px;
    background: #fff;
    border-radius: 4px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    overflow: hidden;
    z-index: 100;
    min-width: 140px;
  }
  .export-dropdown.show {
    display: block;
  }
  .export-dropdown button {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
    padding: 10px 14px;
    border: none;
    background: #fff;
    color: #1B3A6B;
    font-size: 11px;
    font-weight: 500;
    cursor: pointer;
    text-align: left;
  }
  .export-dropdown button:hover {
    background: #EEF4FF;
  }
  .export-dropdown button svg {
    width: 14px;
    height: 14px;
  }
  @media print {
    .export-wrapper { display: none; }
  }
  .footer-section h4 {
    font-size: 9px;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    color: #999;
    margin-bottom: 5px;
    font-weight: 600;
  }
  .footer-section p, .footer-section li {
    font-size: 11px;
    color: #555;
    line-height: 1.7;
    list-style: none;
  }
  .critical-note {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    font-size: 10px;
    color: #C0392B;
    padding: 2px 8px;
    border: 1px solid #C0392B;
    border-radius: 3px;
    margin-top: 4px;
  }

  /* ── PRINT STYLESHEET ── */
  @media print {
    @page {
      size: A3 landscape;
      margin: 6mm 8mm 6mm 6mm;
    }
    body {
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
      background: #fff;
    }
    .page {
      width: 100%;
      max-width: 100%;
      margin: 0;
      border: none;
      box-shadow: none;
      border-radius: 0;
    }
    .gantt-scroll {
      overflow: visible;
    }
    table {
      width: 100%;
      table-layout: fixed;
      font-size: 11px;
    }
    ::-webkit-scrollbar {
      display: none;
    }
    #network { display: none !important; }
  }

  /* ══════════════════════════════════════════════════════════════ */
  /* NETWORK DIAGRAM STYLES (prefixed with net-)                    */
  /* ══════════════════════════════════════════════════════════════ */
  :root {
    --c11: #1B5AB4;
    --c12: #D4500A;
    --c13: #0A7A4A;
    --c14: #6B2FAA;
    --c15: #A07B00;
    --cp:  #C0392B;
    --cp-bg: #FFF0EE;
    --float-bg: #F8FAFF;
    --border: #DDE2EC;
    --bg: #F2F5FB;
    --white: #FFFFFF;
    --text: #1A1A2E;
    --muted: #6B7280;
    --node-w: 168px;
    --node-h: 110px;
  }

  #network { background: var(--bg); }

  .net-header {
    background: #1B3A6B;
    padding: 18px 32px 50px;
    color: #fff;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    position: relative;
    min-height: 100px;
  }
  .net-header h1 {
    font-family: 'Playfair Display', serif;
    font-size: 20px;
    font-weight: 700;
  }
  .net-header h1 span { color: #60A5FA; }
  .net-header .sub { font-size: 11px; color: rgba(255,255,255,0.6); margin-top: 3px; }
  .net-header-meta {
    display: flex; gap: 20px; flex-wrap: wrap;
    padding-top: 10px;
    border-top: 1px solid rgba(255,255,255,0.1);
    font-size: 10px; color: rgba(255,255,255,0.6);
    position: absolute; bottom: 12px; left: 32px; right: 32px;
  }
  .net-header-meta span { color: #fff; font-weight: 500; }

  .net-legend-bar {
    display: flex; gap: 6px; flex-wrap: wrap;
    padding: 10px 32px;
    background: #fff;
    border-bottom: 1px solid var(--border);
    align-items: center;
  }
  .net-leg-label { font-size: 10px; color: #888; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; margin-right: 4px; }
  .net-leg {
    display: flex; align-items: center; gap: 5px;
    font-size: 10px; padding: 3px 9px;
    border-radius: 3px; border: 1px solid;
  }
  .net-leg-dot { width: 9px; height: 9px; border-radius: 2px; }

  .net-node-key {
    display: flex; align-items: flex-start; gap: 32px;
    padding: 10px 32px;
    background: #F8FAFD;
    border-bottom: 1px solid var(--border);
    flex-wrap: wrap;
  }
  .net-node-key-label { font-size: 10px; color: #888; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 5px; }
  .net-node-sample {
    background: #fff;
    border: 2px solid #1B5AB4;
    border-radius: 6px;
    width: 160px;
    font-size: 9px;
  }
  .net-node-sample .ns-header {
    background: #1B5AB4; color: #fff;
    padding: 3px 6px; font-weight: 700; font-size: 9px;
    border-radius: 4px 4px 0 0;
    display: flex; justify-content: space-between;
  }
  .net-node-sample .ns-name {
    padding: 3px 6px 2px;
    font-size: 8.5px; font-weight: 600; color: #1A1A2E;
    border-bottom: 1px solid #EEF0F5;
    text-align: center;
  }
  .net-node-sample .ns-grid {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 0;
  }
  .net-ns-cell {
    padding: 3px 5px;
    border-right: 1px solid #EEF0F5;
    border-bottom: 1px solid #EEF0F5;
  }
  .net-ns-cell:nth-child(even) { border-right: none; }
  .net-ns-cell .ns-lbl { font-size: 7px; color: #888; text-transform: uppercase; letter-spacing: 0.3px; }
  .net-ns-cell .ns-val { font-size: 9px; font-weight: 600; color: #1A1A2E; }
  .net-ns-float {
    padding: 3px 6px;
    text-align: center;
    font-size: 8px; font-weight: 700;
  }
  .net-key-notes { font-size: 10px; color: #555; line-height: 1.9; }
  .net-key-notes strong { color: #1A1A2E; }

  .net-canvas-wrap {
    overflow: auto;
    padding: 32px;
    position: relative;
  }

  #netSvg {
    display: block;
    overflow: visible;
  }

  .node-group { cursor: default; }
  .node-rect {
    rx: 6; ry: 6;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
  }
  .node-rect.critical { stroke-width: 2.5; }
  .node-header { font-size: 9px; font-weight: 700; fill: #fff; }
  .node-name { font-size: 8.5px; font-weight: 600; fill: #1A1A2E; }
  .node-label { font-size: 8px; fill: #666; }
  .node-value { font-size: 9px; font-weight: 700; fill: #1A1A2E; }
  .node-float-text { font-size: 8.5px; font-weight: 700; }
  .node-divider { stroke: #EEF0F5; stroke-width: 1; }

  .arrow-label {
    font-size: 8px;
    fill: #888;
    font-family: 'Inter', sans-serif;
  }
  .arrow-label.cp { fill: var(--cp); font-weight: 600; }

  .net-cp-badge {
    display: inline-flex; align-items: center; gap: 5px;
    font-size: 9px; color: var(--cp);
    padding: 2px 6px; border: 1px solid var(--cp);
    border-radius: 3px; margin-top: 4px;
    background: var(--cp-bg);
  }

  .net-export-wrap {
    position: relative;
    display: inline-block;
  }
  .net-export-btn {
    display: flex; align-items: center; gap: 6px;
    background: #2563EB; color: #fff;
    border: none; border-radius: 5px;
    padding: 7px 14px; font-size: 11px;
    font-weight: 600; cursor: pointer;
    font-family: 'Inter', sans-serif;
    transition: background 0.2s;
  }
  .net-export-btn:hover { background: #1D4ED8; }
  .net-export-btn svg { width: 14px; height: 14px; }
  .net-export-dropdown {
    display: none; position: absolute;
    top: 100%; right: 0; margin-top: 4px;
    background: #fff; border-radius: 6px;
    box-shadow: 0 4px 16px rgba(0,0,0,0.15);
    min-width: 160px; z-index: 100;
    overflow: hidden;
  }
  .net-export-dropdown.show { display: block; }
  .net-export-dropdown button {
    display: block; width: 100%;
    padding: 10px 14px; border: none;
    background: #fff; text-align: left;
    font-size: 11px; color: #333;
    cursor: pointer; font-family: 'Inter', sans-serif;
  }
  .net-export-dropdown button:hover { background: #F3F4F6; }
  .net-export-dropdown button span { color: #888; font-size: 9px; display: block; margin-top: 2px; }

  @media print {
    .net-export-wrap { display: none !important; }
  }

  /* Network print styles */
  @media print {
    #network .net-header { padding: 12px 24px 10px; }
    #network .net-header h1 { font-size: 18px; }
    #network .net-legend-bar { padding: 8px 24px; }
    #network .net-node-key { 
      padding: 8px 24px; 
      gap: 12px; 
      flex-wrap: nowrap;
      overflow: visible;
    }
    #network .net-key-notes { 
      font-size: 8px; 
      line-height: 1.4; 
      flex-shrink: 1;
      min-width: 0;
    }
    #network .net-key-notes p { font-size: 8px; }
    #network .net-node-sample { width: 140px; }
    #network .net-canvas-wrap {
      padding: 16px 24px;
      overflow: visible;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }
    #network #netSvg {
      width: auto !important;
      height: auto !important;
      max-width: 100%;
      transform: none;
    }
  }
</style>
</head>
<body>

<!-- ══ TAB NAVIGATION ══════════════════════════════════════════ -->
<div class="tab-nav">
  <button class="tab-btn active" onclick="showTab('gantt')">Gantt Chart</button>
  <button class="tab-btn" onclick="showTab('network')">Network Diagram</button>
  <button class="tab-btn" onclick="showTab('charter')">Project Charter</button>
  <button class="tab-btn" onclick="showTab('wbs')">WBS</button>
</div>

<!-- ══ GANTT CHART TAB ══════════════════════════════════════════ -->
<div id="gantt" class="tab-content">
<div class="page">

<!-- ══ HEADER ══════════════════════════════════════════════ -->
<div class="header">
  <div class="header-top">
    <div>
      <h1>DeerghAyu Seniors Program - Project Plan Gantt Chart</h1>
      <div class="tagline">Greater Toronto Area · AI-Enabled Elder Health Management Program · Funder-Ready Project Plan</div>
    </div>
    <div style="text-align:right;font-size:11px;color:rgba(255,255,255,0.7);line-height:1.8">
      <div>Sponsor: <strong style="color:#fff">Ashok Ranade</strong></div>
      <div>Project Manager: <strong style="color:#fff">Kehinde Obidele</strong></div>
      <div class="export-wrapper">
        <button class="export-btn" onclick="toggleExportMenu()">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
          </svg>
          Export
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width:10px;height:10px;margin-left:2px">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div class="export-dropdown" id="exportDropdown">
          <button onclick="exportToPNG()">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
            Export as PNG
          </button>
          <button onclick="exportToPDF()">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
            </svg>
            Export as PDF
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="header-meta">
    <div class="meta-item">Project Start: <span>January 7, 2026</span></div>
    <div class="meta-item">Project End: <span>April 8, 2026</span></div>
    <div class="meta-item">Duration: <span>13 Weeks</span></div>
    <div class="meta-item">Total Deliverables: <span>24</span></div>
    <div class="meta-item">Team Size: <span>6 members</span></div>
    <div class="meta-item">Client: <span>DeerghAyu Wellness Trust</span></div>
  </div>
</div>

<!-- ══ LEGEND ══════════════════════════════════════════════ -->
<div class="legend-bar">
  <span class="legend-label">Phases:</span>
  <span class="leg" style="color:#1B5AB4;border-color:#1B5AB4;background:#EEF4FF">
    <span class="leg-dot" style="background:#1B5AB4"></span>1.1 Project Management
  </span>
  <span class="leg" style="color:#D4500A;border-color:#D4500A;background:#FFF1EB">
    <span class="leg-dot" style="background:#D4500A"></span>1.2 Program Design
  </span>
  <span class="leg" style="color:#0A7A4A;border-color:#0A7A4A;background:#EDFAF4">
    <span class="leg-dot" style="background:#0A7A4A"></span>1.3 Technology &amp; Data
  </span>
  <span class="leg" style="color:#6B2FAA;border-color:#6B2FAA;background:#F5EEFF">
    <span class="leg-dot" style="background:#6B2FAA"></span>1.4 Stakeholder &amp; Comms
  </span>
  <span class="leg" style="color:#A07B00;border-color:#A07B00;background:#FFFAEB">
    <span class="leg-dot" style="background:#C49A00"></span>1.5 Funding &amp; Go-to-Market
  </span>
  <span class="leg" style="color:#C0392B;border-color:#C0392B;background:#FFF0EE">
    <span class="leg-dot" style="background:#C0392B;transform:rotate(45deg)"></span>◆ Milestone / Deadline
  </span>
  <span class="leg" style="color:#C0392B;border-color:#C0392B;background:#FFF0EE">
    <span style="background:#C0392B;color:#fff;font-size:8px;font-weight:700;padding:2px 5px;border-radius:2px;letter-spacing:0.3px">CP</span> Critical Path
  </span>
</div>

<!-- ══ GANTT TABLE ══════════════════════════════════════════ -->
<div class="gantt-scroll">
<table id="ganttTable">
  <thead id="ganttHead"></thead>
  <tbody id="ganttBody"></tbody>
</table>
</div>

<!-- ══ FOOTER ══════════════════════════════════════════════ -->
<div class="footer">
  <div class="footer-section">
    <h4>Project Objective</h4>
    <p>Produce a government- and funder-ready project plan enabling<br>
    DeerghAyu Wellness Trust to secure Canadian government funding<br>
    and launch an AI-enabled elder health management program.</p>
  </div>
  <div class="footer-section">
    <h4>Key Milestones</h4>
    <ul>
      <li>◆ Jan 28 - Charter Submitted</li>
      <li>◆ Feb 7 &nbsp;- WBS Complete</li>
      <li>◆ 3/1 &nbsp;&nbsp;&nbsp;- First Plan Draft</li>
      <li>◆ Apr 1 &nbsp;- Final Project Plan Draft</li>
    </ul>
  </div>
  <div class="footer-section">
    <h4>Team Members</h4>
    <ul>
      <li>Kehinde Obidele - Project Lead</li>
      <li>Dinsha Madhyan - Program Design</li>
      <li>Zahid Mohammed - Technology &amp; Data</li>
      <li>Srinidhi Rajaraman - Stakeholder</li>
      <li>Lavanya Ramaswamy - Funding</li>
      <li>Robiya Nabieva - Communications</li>
    </ul>
  </div>
  <div class="footer-section">
    <h4>Scope Note</h4>
    <p>This Gantt chart covers the project planning<br>
    phase only. Implementation, development,<br>
    and live pilot are out of scope.</p>
  </div>
  <div class="footer-section">
    <h4>Legend</h4>
    <div class="critical-note"><span style="background:#C0392B;color:#fff;font-size:8px;font-weight:700;padding:2px 5px;border-radius:2px;margin-right:5px">CP</span> Critical path tasks marked with CP tag</div>
  </div>
</div>

</div><!-- end .page -->
</div><!-- end #gantt -->

<!-- ══ NETWORK DIAGRAM TAB ══════════════════════════════════════ -->
<div id="network" class="tab-content" style="display:none">

<!-- HEADER -->
<div class="net-header">
  <div>
    <h1>DeerghAyu <span>Seniors Program</span> - Network Diagram (AON)</h1>
    <div class="sub">Activity on Node · Precedence Diagram Method · Critical Path Analysis</div>
  </div>
  <div class="net-export-wrap">
    <button class="net-export-btn" onclick="toggleNetExportMenu()">
      <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M7 10l5 5m0 0l5-5m-5 5V3"/></svg>
      Export ▾
    </button>
    <div class="net-export-dropdown" id="netExportMenu">
      <button onclick="netExportPNG()">
        PNG Image
        <span>Diagram only, high resolution</span>
      </button>
      <button onclick="netExportPDF()">
        PDF Document
        <span>Full page, single sheet</span>
      </button>
    </div>
  </div>
  <div class="net-header-meta">
    <div>Project: <span>DeerghAyu Wellness Trust - AI-Enabled Elder Health Management</span></div>
    <div>Project Manager: <span>Kehinde Obidele</span></div>
    <div>Sponsor: <span>Ashok Ranade</span></div>
    <div>Timeline: <span>Jan 7 – Apr 8, 2026 (13 Weeks)</span></div>
  </div>
</div>

<!-- LEGEND -->
<div class="net-legend-bar">
  <span class="net-leg-label">Phases:</span>
  <span class="net-leg" style="color:#1B5AB4;border-color:#1B5AB4;background:#EEF4FF"><span class="net-leg-dot" style="background:#1B5AB4"></span>1.1 Project Mgmt</span>
  <span class="net-leg" style="color:#D4500A;border-color:#D4500A;background:#FFF1EB"><span class="net-leg-dot" style="background:#D4500A"></span>1.2 Program Design</span>
  <span class="net-leg" style="color:#0A7A4A;border-color:#0A7A4A;background:#EDFAF4"><span class="net-leg-dot" style="background:#0A7A4A"></span>1.3 Technology &amp; Data</span>
  <span class="net-leg" style="color:#6B2FAA;border-color:#6B2FAA;background:#F5EEFF"><span class="net-leg-dot" style="background:#6B2FAA"></span>1.4 Stakeholder &amp; Comms</span>
  <span class="net-leg" style="color:#A07B00;border-color:#A07B00;background:#FFFAEB"><span class="net-leg-dot" style="background:#C49A00"></span>1.5 Funding &amp; Go-to-Market</span>
  <span class="net-leg" style="color:#C0392B;border-color:#C0392B;background:#FFF0EE"><span class="net-leg-dot" style="background:#C0392B"></span>Critical Path (Float = 0)</span>
  <span class="net-leg" style="color:#555;border-color:#ccc;background:#F8F8F8"><span class="net-leg-dot" style="background:#ccc"></span>Non-Critical (Float &gt; 0)</span>
</div>

<!-- NODE KEY -->
<div class="net-node-key">
  <div>
    <div class="net-node-key-label">Node Structure (AON Format)</div>
    <div class="net-node-sample">
      <div class="ns-header"><span>1.1.1</span><span style="font-size:8px;font-weight:400">Phase 1.1</span></div>
      <div class="ns-name">Charter &amp; Scope Statement</div>
      <div class="ns-grid">
        <div class="net-ns-cell"><div class="ns-lbl">ES</div><div class="ns-val">W3</div></div>
        <div class="net-ns-cell"><div class="ns-lbl">EF</div><div class="ns-val">W4</div></div>
        <div class="net-ns-cell"><div class="ns-lbl">LS</div><div class="ns-val">W3</div></div>
        <div class="net-ns-cell"><div class="ns-lbl">LF</div><div class="ns-val">W4</div></div>
        <div class="net-ns-cell" style="grid-column:span 2"><div class="ns-lbl">Duration</div><div class="ns-val">2 weeks</div></div>
      </div>
      <div class="net-ns-float" style="background:#FFF0EE;color:#C0392B">Float = 0 · CRITICAL PATH</div>
    </div>
  </div>
  <div class="net-key-notes">
    <div class="net-node-key-label">How to read this diagram</div>
    <p><strong>ES</strong> = Earliest possible start week</p>
    <p><strong>EF</strong> = Earliest possible finish week</p>
    <p><strong>LS</strong> = Latest allowable start (without delaying project)</p>
    <p><strong>LF</strong> = Latest allowable finish (without delaying project)</p>
    <p><strong>Float</strong> = How many weeks a task can slip before delaying the project</p>
    <p><strong>Float = 0</strong> = Critical Path - zero room for delay</p>
    <p><strong>Arrows</strong> = Finish-to-Start dependency (predecessor must finish before successor starts)</p>
  </div>
  <div class="net-key-notes">
    <div class="net-node-key-label">Critical Path Summary</div>
    <p>Three parallel paths tied at <strong>19 weeks</strong>:</p>
    <p>Path B: 1.1.1→1.2.1→1.2.2→1.2.3→1.2.4→1.5.1→1.5.4</p>
    <p>Path C: 1.1.1→1.1.2→1.3.1→1.3.2→1.3.3→1.3.4→1.5.4</p>
    <p>Path D: 1.1.1→1.4.1→1.4.2→1.4.3→1.5.1→1.5.2→1.5.4</p>
    <p style="margin-top:4px;color:#C0392B;font-weight:600">Any delay in these chains = project delay</p>
  </div>
  <div class="net-key-notes">
    <div class="net-node-key-label">Dependency Type</div>
    <p>All dependencies: <strong>Finish-to-Start (FS)</strong></p>
    <p>Predecessor must complete before successor starts.</p>
    <div class="net-cp-badge">◆ Float = 0 means Critical Path</div>
  </div>
</div>

<!-- CANVAS -->
<div class="net-canvas-wrap">
  <svg id="netSvg" xmlns="http://www.w3.org/2000/svg"></svg>
</div>

</div><!-- end #network -->

<!-- ══ PROJECT CHARTER TAB ══════════════════════════════════════ -->
<div id="charter" class="tab-content" style="display:none">
  <iframe src="charter.pdf" width="100%" height="900px" style="border:none;"></iframe>
</div><!-- end #charter -->

<!-- ══ WBS TAB ══════════════════════════════════════════════════ -->
<div id="wbs" class="tab-content" style="display:none">
  <iframe src="wbs.pdf" width="100%" height="900px" style="border:none;"></iframe>
</div><!-- end #wbs -->

<script>
// ══════════════════════════════════════════════════════════════
// TAB SWITCHING
// ══════════════════════════════════════════════════════════════
function showTab(name) {
  document.querySelectorAll('.tab-content').forEach(el => el.style.display = 'none');
  document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
  document.getElementById(name).style.display = 'block';
  event.target.classList.add('active');
  
  // Initialize network diagram when switching to it
  if (name === 'network' && !window.networkInitialized) {
    initNetworkDiagram();
    window.networkInitialized = true;
  }
}

// ══════════════════════════════════════════════════════════════
// GANTT CHART CONFIGURATION
// ══════════════════════════════════════════════════════════════
const WEEK_W  = 24;   // px per week column
const START   = new Date(2026, 0, 7); // Jan 7, 2026 (Mon)
const N_WEEKS = 13;

// Hardcoded week date labels
const WEEK_DATES = ['Jan 7','Jan 14','Jan 21','Jan 28','Feb 4','Feb 11','Feb 18','Feb 25','Mar 11','Mar 18','Mar 25','Apr 1','Apr 8'];

// Team colors
const OWNERS = {
  KO: { name:'Kehinde',  color:'#1B5AB4' },
  DM: { name:'Dinsha',   color:'#D4500A' },
  ZH: { name:'Zahid',    color:'#0A7A4A' },
  SR: { name:'Srinidhi', color:'#6B2FAA' },
  LR: { name:'Lavanya',  color:'#A07B00' },
  RN: { name:'Robiya',   color:'#C0392B' },
  Team: { name:'Team', color:'#555' },
};

// Phase colors (added 'dark' for critical path tasks)
const PHASE_COLORS = {
  '1.1': { bar:'#1B5AB4', dark:'#0F3D7A', light:'#EEF4FF', text:'#1B5AB4' },
  '1.2': { bar:'#D4500A', dark:'#9A3A06', light:'#FFF1EB', text:'#D4500A' },
  '1.3': { bar:'#0A7A4A', dark:'#065A36', light:'#EDFAF4', text:'#0A7A4A' },
  '1.4': { bar:'#6B2FAA', dark:'#4A1F78', light:'#F5EEFF', text:'#6B2FAA' },
  '1.5': { bar:'#C49A00', dark:'#8A6C00', light:'#FFFAEB', text:'#A07B00' },
};

// ── DATE HELPERS ─────────────────────────────────────────────
function addDays(d, n) {
  const r = new Date(d); r.setDate(r.getDate()+n); return r;
}
function weekOf(d) {
  // returns 1-indexed week number from START
  const diff = (d - START) / (7*24*3600*1000);
  return Math.floor(diff) + 1;
}
function fmtDate(d) {
  return (d.getMonth()+1)+'/'+d.getDate()+'/'+String(d.getFullYear()).slice(2);
}
function weekStart(w) { return addDays(START, (w-1)*7); }
function weekEnd(w)   { return addDays(START,  w*7 - 1); }

// Week → month label (uses hardcoded WEEK_DATES array)
function monthLabel(w) {
  return WEEK_DATES[w-1] || '';
}

// ── DATA ─────────────────────────────────────────────────────
// sw = start week (1-indexed from Jan 26)
// ew = end week
// critical = on critical path
// milestone = diamond marker

const PHASES = [
  {
    id:'1.1', name:'Project Management Package', color:'1.1',
    tasks:[
      { id:'M1',    name:'◆ Charter Submitted',              sw:4,  ew:4,  owner:'Team', milestone:true, progress:100 },
      { id:'1.1.1', name:'Charter & Scope Statement',        sw:3,  ew:4,  owner:'Team', critical:true, progress:100 },
      { id:'1.1.2', name:'WBS Development',                  sw:4,  ew:5,  owner:'Team', critical:true, progress:100 },
      { id:'M2',    name:'◆ WBS Submitted',                  sw:5,  ew:5,  owner:'Team', milestone:true, progress:100 },
      { id:'1.1.3', name:'Schedule Baseline (draft)',         sw:5,  ew:6,  owner:'KO', critical:true, progress:80 },
      { id:'1.1.4', name:'Budget & Resource Plan',            sw:6,  ew:7,  owner:'DM', progress:60 },
      { id:'1.1.5', name:'Risk & Issue Log',                  sw:7,  ew:8,  owner:'KO', progress:40 },
      { id:'M3',    name:'◆ First Draft Plan Due',            sw:8,  ew:8,  owner:'KO', milestone:true, progress:0 },
      { id:'1.1.6', name:'Governance & Change Control Plan',  sw:8,  ew:9,  owner:'KO', progress:20 },
      { id:'1.1.7', name:'RACI Matrix',                       sw:9,  ew:10, owner:'SR', progress:0 },
    ]
  },
  {
    id:'1.2', name:'Program Design Package', color:'1.2',
    tasks:[
      { id:'1.2.1', name:'Target Population Definition',          sw:5, ew:6, owner:'DM', progress:90 },
      { id:'1.2.2', name:'Service Model & Workflow Design',        sw:6, ew:8, owner:'DM', critical:true, progress:70 },
      { id:'1.2.3', name:'Caregiver Enablement Approach',          sw:7, ew:9, owner:'RN', progress:50 },
      { id:'1.2.4', name:'Training Plan for Seniors & Caregivers', sw:8, ew:10, owner:'LR', progress:20 },
    ]
  },
  {
    id:'1.3', name:'Technology & Data Package', color:'1.3',
    tasks:[
      { id:'1.3.1', name:'PHA Functional Requirements',           sw:6, ew:8, owner:'ZH', critical:true, progress:60 },
      { id:'1.3.2', name:'Data Inputs & Tracking Templates',      sw:7, ew:9, owner:'ZH', progress:40 },
      { id:'1.3.3', name:'Doctor-Ready Summary Template',         sw:8, ew:10, owner:'ZH', progress:20 },
      { id:'1.3.4', name:'Privacy, Security & Consent Approach',  sw:9, ew:11, owner:'ZH', progress:0 },
    ]
  },
  {
    id:'1.4', name:'Stakeholder & Communications Package', color:'1.4',
    tasks:[
      { id:'1.4.1', name:'Stakeholder Register',              sw:5, ew:6, owner:'SR', progress:90 },
      { id:'1.4.2', name:'Communications Plan',               sw:6, ew:8, owner:'RN', critical:true, progress:60 },
      { id:'1.4.3', name:'Partner Engagement Materials',      sw:8, ew:10, owner:'SR', progress:20 },
    ]
  },
  {
    id:'1.5', name:'Funding & Go-to-Market Package', color:'1.5',
    tasks:[
      { id:'1.5.1', name:'Funding Strategy & Criteria Mapping',     sw:8,  ew:10, owner:'LR', critical:true, progress:20 },
      { id:'1.5.2', name:'Cost-Benefit & ROI Narrative',             sw:9,  ew:11, owner:'LR', critical:true, progress:10 },
      { id:'1.5.3', name:'Pilot Rollout Plan (phases)',              sw:10, ew:11, owner:'DM', progress:0 },
      { id:'1.5.4', name:'Final Proposal Deck / Submission Package', sw:10, ew:12, owner:'KO', critical:true, progress:0 },
      { id:'1.5.5', name:'Success Metrics Framework',                sw:10, ew:11, owner:'SR', progress:0 },
      { id:'M4',    name:'◆ Final Submission - Apr 1',               sw:12, ew:12, owner:'KO', milestone:true, progress:0 },
    ]
  }
];

// ── BUILD THEAD ───────────────────────────────────────────────
const thead = document.getElementById('ganttHead');

// Row 1: fixed headers (span 3 rows) + month groups
const r1 = document.createElement('tr');
r1.className = 'col-header';

const fixedCols = [
  {label:'WBS ID',      cls:'col-id',    rowspan:3},
  {label:'Task / Deliverable', cls:'col-task', rowspan:3},
  {label:'Assigned To', cls:'col-owner', rowspan:3},
  {label:'Start Date',  cls:'col-start', rowspan:3},
  {label:'End Date',    cls:'col-end',   rowspan:3},
  {label:'Duration',    cls:'col-dur',   rowspan:3},
  {label:'Progress',    cls:'col-prog',  rowspan:3},
];
fixedCols.forEach(c => {
  const th = document.createElement('th');
  th.textContent = c.label;
  th.className = c.cls;
  th.rowSpan = c.rowspan;
  th.style.cssText = `background:#1B3A6B;border:1px solid #2A4E8A;padding:7px 8px;
    font-size:10px;font-weight:600;color:#fff;text-transform:uppercase;letter-spacing:0.4px;
    white-space:nowrap;text-align:left;vertical-align:middle`;
  r1.appendChild(th);
});

// Group weeks by month for the month header row
let monthGroups = [];
let curMonth = -1, curCount = 0;
for (let w = 1; w <= N_WEEKS; w++) {
  const d = weekStart(w);
  const m = d.getMonth();
  if (m !== curMonth) {
    if (curCount > 0) monthGroups[monthGroups.length-1].count = curCount;
    monthGroups.push({ name: d.toLocaleString('default',{month:'short', year:'numeric'}), count:0, start:w });
    curMonth = m; curCount = 0;
  }
  curCount++;
}
if (monthGroups.length) monthGroups[monthGroups.length-1].count = curCount;

// today = Feb 21 → week 7 (Feb 18-24)
const TODAY_WEEK = 7; // Feb 21 is in week 7

monthGroups.forEach(mg => {
  const th = document.createElement('th');
  th.textContent = mg.name;
  th.colSpan = mg.count;
  th.style.cssText = `background:#1B3A6B;color:#fff;font-size:11px;font-weight:600;
    text-align:center;padding:6px 4px;border:1px solid #2A4E8A`;
  r1.appendChild(th);
});
thead.appendChild(r1);

// Row 2: week date labels
const r2 = document.createElement('tr');
for (let w = 1; w <= N_WEEKS; w++) {
  const th = document.createElement('th');
  th.textContent = monthLabel(w);
  th.style.cssText = `background:${w===TODAY_WEEK?'#1B5AB4':'#EEF2FA'};
    color:${w===TODAY_WEEK?'#fff':'#444'};
    font-size:9px;font-weight:600;text-align:center;
    padding:4px 2px;border:1px solid #DDE2EC;
    min-width:${WEEK_W}px;white-space:nowrap`;
  r2.appendChild(th);
}
thead.appendChild(r2);

// Row 3: W1, W2... labels
const r3 = document.createElement('tr');
for (let w = 1; w <= N_WEEKS; w++) {
  const th = document.createElement('th');
  th.textContent = 'W'+w;
  th.style.cssText = `background:${w===TODAY_WEEK?'rgba(27,90,180,0.15)':'#F5F7FC'};
    color:#666;font-size:9px;font-weight:500;text-align:center;
    padding:3px 2px;border:1px solid #DDE2EC;min-width:${WEEK_W}px`;
  r3.appendChild(th);
}
thead.appendChild(r3);

// ── BUILD TBODY ───────────────────────────────────────────────
const tbody = document.getElementById('ganttBody');

PHASES.forEach(phase => {
  const pc = PHASE_COLORS[phase.color];

  // Phase header row
  const phRow = document.createElement('tr');
  phRow.style.cssText = `background:${pc.light}`;

  const phTd = document.createElement('td');
  phTd.colSpan = 7 + N_WEEKS;
  phTd.style.cssText = `padding:7px 12px;border-bottom:1px solid #DDE2EC;
    border-top:2px solid ${pc.bar}`;
  phTd.innerHTML = `
    <span style="background:${pc.bar};color:#fff;font-size:10px;font-weight:700;
      padding:2px 9px;border-radius:3px;margin-right:8px">${phase.id}</span>
    <span style="font-size:12px;font-weight:700;color:${pc.text}">${phase.name}</span>
    <span style="font-size:10px;color:#999;margin-left:8px">${phase.tasks.length} deliverables</span>`;
  phRow.appendChild(phTd);
  tbody.appendChild(phRow);

  // Task rows
  phase.tasks.forEach(task => {
    const isMilestone = !!task.milestone;
    const isCritical  = !!task.critical;
    const owner = OWNERS[task.owner];

    // dates
    const sd = weekStart(task.sw);
    const ed = weekEnd(task.ew);
    const dur = task.ew - task.sw + 1;

    const tr = document.createElement('tr');
    tr.className = 'task-row' + (isMilestone?' milestone-row':'');

    // WBS ID
    const tdId = document.createElement('td');
    tdId.className = 'td-id';
    tdId.textContent = isMilestone ? '◆' : task.id;
    tdId.style.cssText = `text-align:center;font-size:${isMilestone?'12px':'10px'};
      color:${isMilestone?'#C0392B':'#888'};font-weight:${isMilestone?'700':'500'};
      border:1px solid #EEF0F5;padding:5px 4px;white-space:nowrap`;
    tr.appendChild(tdId);

    // Task name
    const tdTask = document.createElement('td');
    tdTask.className = 'td-task' + (isMilestone?' is-milestone':'');
    tdTask.style.cssText = `padding:5px 8px 5px ${isMilestone?'16':'20'}px;
      border:1px solid #EEF0F5;white-space:nowrap;
      font-size:11px;color:${isMilestone?'#C0392B':'#1A1A2E'};
      font-weight:${isMilestone||isCritical?'600':'400'};
      ${isCritical?'border-left:3px solid #C0392B;padding-left:17px;':''}`;
    tdTask.innerHTML = isMilestone
      ? `<span style="display:inline-block;width:7px;height:7px;background:#C0392B;transform:rotate(45deg);margin-right:6px;vertical-align:middle"></span>${task.name}`
      : task.name;
    tr.appendChild(tdTask);

    // Owner
    const tdOwner = document.createElement('td');
    tdOwner.className = 'td-owner';
    tdOwner.style.cssText = `border:1px solid #EEF0F5;padding:5px 6px`;
    tdOwner.innerHTML = `<span class="owner-chip" style="background:${owner.color}">${owner.name}</span>`;
    tr.appendChild(tdOwner);

    // Start date
    const tdStart = document.createElement('td');
    tdStart.className = 'td-date';
    tdStart.textContent = fmtDate(sd);
    tdStart.style.cssText = `border:1px solid #EEF0F5;padding:5px 6px;text-align:center;font-size:10px;color:#444`;
    tr.appendChild(tdStart);

    // End date
    const tdEnd = document.createElement('td');
    tdEnd.className = 'td-date';
    tdEnd.textContent = fmtDate(ed);
    tdEnd.style.cssText = `border:1px solid #EEF0F5;padding:5px 6px;text-align:center;font-size:10px;color:#444`;
    tr.appendChild(tdEnd);

    // Duration
    const tdDur = document.createElement('td');
    tdDur.className = 'td-dur';
    tdDur.textContent = isMilestone ? '-' : (dur===1?'1 wk':dur+' wks');
    tdDur.style.cssText = `border:1px solid #EEF0F5;padding:5px 4px;text-align:center;font-size:10px;color:#666`;
    tr.appendChild(tdDur);

    // Progress
    const tdProg = document.createElement('td');
    tdProg.className = 'td-prog';
    tdProg.style.cssText = `border:1px solid #EEF0F5;padding:4px 5px;vertical-align:middle`;
    const prog = task.progress || 0;
    const progColor = isMilestone ? '#C0392B' : pc.bar;
    tdProg.innerHTML = `
      <div style="display:flex;align-items:center;gap:4px">
        <div style="flex:1;position:relative;background:#E8E8E8;border-radius:3px;height:12px;overflow:hidden;min-width:40px">
          <div style="position:absolute;left:0;top:0;height:100%;width:${prog}%;background:${progColor};border-radius:3px;transition:width 0.3s"></div>
        </div>
        <span style="font-size:9px;font-weight:600;color:#555;min-width:24px;text-align:right">${prog}%</span>
      </div>
    `;
    tr.appendChild(tdProg);

    // Week bar cells
    for (let w = 1; w <= N_WEEKS; w++) {
      const td = document.createElement('td');
      td.className = 'week-cell' + (w%2===0?' alt':'') + (w===TODAY_WEEK?' today-col':'');
      td.style.cssText = `border:1px solid #F0F0F5;padding:3px 1px;
        position:relative;min-width:${WEEK_W}px;height:34px;vertical-align:middle;
        ${w%2===0?'background:#FAFBFE':''}
        ${w===TODAY_WEEK?'background:rgba(27,90,180,0.06)!important;border-color:#1B5AB4!important':''}`;

      // Draw bar if this week is within task range
      if (!isMilestone && w >= task.sw && w <= task.ew) {
        const isFirst = (w === task.sw);
        const isLast  = (w === task.ew);
        const barColor = isCritical ? pc.dark : pc.bar;
        const bar = document.createElement('div');
        bar.style.cssText = `
          position:absolute;
          top:50%;transform:translateY(-50%);
          left:${isFirst?2:0}px;
          right:${isLast?2:0}px;
          height:18px;
          background:${barColor};
          border-radius:${isFirst&&isLast?'3px':isFirst?'3px 0 0 3px':isLast?'0 3px 3px 0':'0'};
          box-shadow: 0 1px 3px rgba(0,0,0,0.15);
          display:flex;align-items:center;justify-content:space-between;
          ${isFirst?`padding-left:5px`:''}
          ${isLast&&isCritical?`padding-right:0`:''}
        `;
        // Task ID label on first cell
        let barContent = '';
        if (isFirst && task.ew - task.sw >= 1) {
          barContent += `<span style="font-size:8px;font-weight:600;color:rgba(255,255,255,0.9);white-space:nowrap;overflow:hidden">${task.id}</span>`;
        } else {
          barContent += '<span></span>';
        }
        // CP tag on last cell for critical tasks
        if (isLast && isCritical) {
          barContent += `<span style="
            background:#C0392B;
            color:#fff;
            font-size:7px;
            font-weight:700;
            padding:2px 4px;
            border-radius:0 3px 3px 0;
            margin-left:auto;
            letter-spacing:0.3px;
          ">CP</span>`;
        }
        bar.innerHTML = barContent;
        td.appendChild(bar);
      }

      // Milestone diamond
      if (isMilestone && w === task.sw) {
        const dm = document.createElement('div');
        dm.style.cssText = `position:absolute;top:50%;left:50%;
          transform:translate(-50%,-50%) rotate(45deg);
          width:12px;height:12px;background:#C0392B;
          box-shadow:0 0 6px rgba(192,57,43,0.5)`;
        td.appendChild(dm);
      }

      tr.appendChild(td);
    }

    tbody.appendChild(tr);
  });
});

// ── TODAY INDICATOR row at bottom ────────────────────────────
// We already highlight the column; add a small caption

// ── EXPORT FUNCTIONS ────────────────────────────────────────────
function toggleExportMenu() {
  const dropdown = document.getElementById('exportDropdown');
  dropdown.classList.toggle('show');
}

// Close dropdown when clicking outside
document.addEventListener('click', function(e) {
  const wrapper = document.querySelector('.export-wrapper');
  if (wrapper && !wrapper.contains(e.target)) {
    document.getElementById('exportDropdown').classList.remove('show');
  }
});

function exportToPNG() {
  const dropdown = document.getElementById('exportDropdown');
  dropdown.classList.remove('show');
  
  const btn = document.querySelector('.export-btn');
  const originalText = btn.innerHTML;
  btn.innerHTML = '<span>Exporting...</span>';
  btn.disabled = true;
  
  const page = document.querySelector('.page');
  
  html2canvas(page, {
    scale: 4, // Ultra high resolution (4x) for maximum sharpness
    useCORS: true,
    logging: false,
    backgroundColor: '#ffffff',
    windowWidth: page.scrollWidth,
    windowHeight: page.scrollHeight,
    imageTimeout: 0,
    allowTaint: true
  }).then(canvas => {
    const link = document.createElement('a');
    link.download = 'DeerghAyu_Gantt_Chart.png';
    link.href = canvas.toDataURL('image/png', 1.0);
    link.click();
    
    btn.innerHTML = originalText;
    btn.disabled = false;
  }).catch(err => {
    console.error('Export failed:', err);
    alert('Export failed. Please try again.');
    btn.innerHTML = originalText;
    btn.disabled = false;
  });
}

function exportToPDF() {
  const dropdown = document.getElementById('exportDropdown');
  dropdown.classList.remove('show');
  window.print();
}

// ══════════════════════════════════════════════════════════════
// NETWORK DIAGRAM CODE
// ══════════════════════════════════════════════════════════════

function initNetworkDiagram() {
const NET_PHASES = {
  '1.1': { color: '#1B5AB4', light: '#EEF4FF', label: '1.1 Project Mgmt' },
  '1.2': { color: '#D4500A', light: '#FFF1EB', label: '1.2 Program Design' },
  '1.3': { color: '#0A7A4A', light: '#EDFAF4', label: '1.3 Technology' },
  '1.4': { color: '#6B2FAA', light: '#F5EEFF', label: '1.4 Stakeholder' },
  '1.5': { color: '#C49A00', light: '#FFFAEB', label: '1.5 Funding' },
};

const CP = '#C0392B';
const CP_LIGHT = '#FFF0EE';

const NODES = [
  { id:'START', name:'PROJECT START', phase:'1.1', dur:0, ES:3, EF:3, LS:3, LF:3, float:0, critical:true, isStart:true },
  { id:'1.1.1', name:'Charter & Scope Statement',        phase:'1.1', dur:2, ES:3, EF:4, LS:3, LF:4,  float:0, critical:true },
  { id:'1.1.2', name:'WBS Development',                  phase:'1.1', dur:2, ES:4, EF:5, LS:4, LF:5,  float:0, critical:true },
  { id:'1.1.3', name:'Schedule Baseline',                phase:'1.1', dur:2, ES:5, EF:6, LS:7, LF:8,  float:2, critical:false },
  { id:'1.1.4', name:'Budget & Resource Plan',           phase:'1.1', dur:2, ES:6, EF:7, LS:8, LF:9,  float:2, critical:false },
  { id:'1.1.5', name:'Risk & Issue Log',                 phase:'1.1', dur:2, ES:7, EF:8, LS:9, LF:10, float:2, critical:false },
  { id:'1.1.6', name:'Governance & Change Control',      phase:'1.1', dur:2, ES:8, EF:9, LS:10,LF:11, float:2, critical:false },
  { id:'1.1.7', name:'RACI Matrix',                      phase:'1.1', dur:2, ES:9, EF:10,LS:10,LF:11, float:1, critical:false },
  { id:'1.2.1', name:'Target Population Definition',     phase:'1.2', dur:2, ES:5, EF:6, LS:5, LF:6,  float:0, critical:true },
  { id:'1.2.2', name:'Service Model & Workflow Design',  phase:'1.2', dur:3, ES:6, EF:8, LS:6, LF:8,  float:0, critical:true },
  { id:'1.2.3', name:'Caregiver Enablement Approach',    phase:'1.2', dur:3, ES:7, EF:9, LS:7, LF:9,  float:0, critical:true },
  { id:'1.2.4', name:'Training Plan for Seniors',        phase:'1.2', dur:3, ES:8, EF:10,LS:8, LF:10, float:0, critical:true },
  { id:'1.3.1', name:'PHA Functional Requirements',      phase:'1.3', dur:3, ES:5, EF:7, LS:5, LF:7,  float:0, critical:true },
  { id:'1.3.2', name:'Data Inputs & Tracking Templates', phase:'1.3', dur:3, ES:7, EF:9, LS:7, LF:9,  float:0, critical:true },
  { id:'1.3.3', name:'Doctor-Ready Summary Template',    phase:'1.3', dur:3, ES:8, EF:10,LS:8, LF:10, float:0, critical:true },
  { id:'1.3.4', name:'Privacy, Security & Consent',      phase:'1.3', dur:3, ES:9, EF:11,LS:9, LF:11, float:0, critical:true },
  { id:'1.4.1', name:'Stakeholder Register',             phase:'1.4', dur:2, ES:5, EF:6, LS:5, LF:6,  float:0, critical:true },
  { id:'1.4.2', name:'Communications Plan',              phase:'1.4', dur:3, ES:6, EF:8, LS:6, LF:8,  float:0, critical:true },
  { id:'1.4.3', name:'Partner Engagement Materials',     phase:'1.4', dur:3, ES:8, EF:10,LS:8, LF:10, float:0, critical:true },
  { id:'1.5.1', name:'Funding Strategy & Criteria',      phase:'1.5', dur:3, ES:10,EF:12,LS:10,LF:12, float:0, critical:true },
  { id:'1.5.2', name:'Cost-Benefit & ROI Narrative',     phase:'1.5', dur:3, ES:9, EF:11,LS:10,LF:12, float:1, critical:false },
  { id:'1.5.3', name:'Pilot Rollout Plan (phases)',      phase:'1.5', dur:2, ES:10,EF:11,LS:11,LF:12, float:1, critical:false },
  { id:'1.5.4', name:'Final Proposal Deck',              phase:'1.5', dur:3, ES:11,EF:13,LS:11,LF:13, float:0, critical:true },
  { id:'1.5.5', name:'Success Metrics Framework',        phase:'1.5', dur:2, ES:11,EF:12,LS:12,LF:13, float:1, critical:false },
  { id:'END', name:'PROJECT END', phase:'1.5', dur:0, ES:13,EF:13,LS:13,LF:13, float:0, critical:true, isEnd:true },
];

const EDGES = [
  ['START','1.1.1'],
  ['1.1.1','1.1.2'],['1.1.2','1.1.3'],['1.1.3','1.1.4'],['1.1.4','1.1.5'],['1.1.5','1.1.6'],['1.1.6','1.1.7'],['1.1.7','1.5.4'],
  ['1.1.1','1.2.1'],['1.1.1','1.4.1'],['1.1.2','1.3.1'],
  ['1.2.1','1.2.2'],['1.2.2','1.2.3'],['1.2.3','1.2.4'],['1.2.4','1.5.1'],
  ['1.3.1','1.3.2'],['1.3.2','1.3.3'],['1.3.3','1.3.4'],['1.3.4','1.5.4'],
  ['1.4.1','1.4.2'],['1.4.2','1.4.3'],['1.4.3','1.5.1'],
  ['1.2.2','1.5.1'],['1.3.1','1.5.1'],['1.4.2','1.5.1'],['1.5.1','1.5.2'],['1.5.1','1.5.3'],['1.5.2','1.5.4'],['1.5.3','1.5.4'],['1.5.2','1.5.5'],['1.5.5','1.5.4'],['1.5.4','END'],
];

const NW = 172, NH = 120, HGAP = 44, VGAP = 32;
const MARGIN_X = 24, MARGIN_Y = 24;

const POSITIONS = {
  'START':[0,3],'1.1.1':[1,3],'1.1.2':[2,3],'1.1.3':[3,0],'1.1.4':[4,0],'1.1.5':[5,0],'1.1.6':[6,0],'1.1.7':[7,0],
  '1.2.1':[3,2],'1.2.2':[4,2],'1.2.3':[5,2],'1.2.4':[6,2],
  '1.3.1':[3,4],'1.3.2':[4,4],'1.3.3':[5,4],'1.3.4':[6,4],
  '1.4.1':[3,6],'1.4.2':[4,6],'1.4.3':[5,6],
  '1.5.1':[7,3],'1.5.2':[8,2],'1.5.3':[8,4],'1.5.4':[9,3],'1.5.5':[8,5],'END':[10,3],
};

function nodeX(id) { return MARGIN_X + POSITIONS[id][0] * (NW + HGAP); }
function nodeY(id) { return MARGIN_Y + POSITIONS[id][1] * (NH + VGAP); }

const maxCol = Math.max(...Object.values(POSITIONS).map(p=>p[0]));
const maxRow = Math.max(...Object.values(POSITIONS).map(p=>p[1]));
const SVG_W = MARGIN_X * 2 + (maxCol+1)*(NW+HGAP);
const SVG_H = MARGIN_Y * 2 + (maxRow+1)*(NH+VGAP);

const svg = document.getElementById('netSvg');
svg.setAttribute('width', SVG_W);
svg.setAttribute('height', SVG_H);
svg.setAttribute('viewBox', `0 0 ${SVG_W} ${SVG_H}`);

function mkEl(tag, attrs={}) {
  const el = document.createElementNS('http://www.w3.org/2000/svg', tag);
  Object.entries(attrs).forEach(([k,v]) => el.setAttribute(k,v));
  return el;
}

function getNode(id) { return NODES.find(n=>n.id===id); }
function isEdgeCritical(from, to) {
  const f = getNode(from), t = getNode(to);
  return f && t && f.critical && t.critical;
}

const defs = mkEl('defs');
function addMarker(id, color) {
  const marker = mkEl('marker', { id, markerWidth:'8', markerHeight:'8', refX:'7', refY:'3', orient:'auto' });
  marker.appendChild(mkEl('path', { d:'M0,0 L0,6 L8,3 z', fill:color }));
  defs.appendChild(marker);
}
addMarker('arr-cp', CP);
addMarker('arr-gray', '#AAAAAA');
svg.appendChild(defs);

// Draw edges
const edgeGroup = mkEl('g', { id:'edges' });
EDGES.forEach(([fromId, toId]) => {
  const cp = isEdgeCritical(fromId, toId);
  const color = cp ? CP : '#BBBBBB';
  const marker = cp ? 'arr-cp' : 'arr-gray';
  const fx = nodeX(fromId) + NW, fy = nodeY(fromId) + NH/2;
  const tx = nodeX(toId), ty = nodeY(toId) + NH/2;
  const fromRow = POSITIONS[fromId][1], toRow = POSITIONS[toId][1];
  const fromCol = POSITIONS[fromId][0], toCol = POSITIONS[toId][0];
  let pathD;
  if (fromRow === toRow) pathD = `M${fx},${fy} L${tx},${ty}`;
  else if (toCol > fromCol) { const midX = fx + (tx - fx) / 2; pathD = `M${fx},${fy} C${midX},${fy} ${midX},${ty} ${tx},${ty}`; }
  else { const midX = Math.min(fx, tx) - 20; pathD = `M${fx},${fy} L${midX},${fy} L${midX},${ty} L${tx},${ty}`; }
  edgeGroup.appendChild(mkEl('path', { d: pathD, fill: 'none', stroke: color, 'stroke-width': cp ? '2.5' : '1.5', 'marker-end': `url(#${marker})`, opacity: cp ? '1' : '0.6' }));
});
svg.appendChild(edgeGroup);

// Draw nodes
const nodeGroup = mkEl('g', { id:'nodes' });
NODES.forEach(node => {
  const x = nodeX(node.id), y = nodeY(node.id);
  const phase = NET_PHASES[node.phase];
  const isCrit = node.critical;
  const borderColor = isCrit ? CP : '#CCCCCC';
  const headerColor = isCrit ? CP : phase.color;
  const bgColor = isCrit ? CP_LIGHT : '#FFFFFF';
  const floatBg = isCrit ? CP_LIGHT : '#F0F7FF';
  const floatTxt = isCrit ? CP : '#1B5AB4';
  const floatLabel = isCrit ? 'Float = 0 · CRITICAL' : `Float = ${node.float} wk${node.float!==1?'s':''}`;

  const g = mkEl('g', { class:'node-group', transform:`translate(${x},${y})` });

  if (node.isStart || node.isEnd) {
    g.appendChild(mkEl('rect', { x:0, y:0, width:NW, height:NH, rx:8, ry:8, fill:CP, stroke:CP, 'stroke-width':'2.5', filter:'drop-shadow(0 2px 6px rgba(192,57,43,0.3))' }));
    const t1 = mkEl('text', { x:NW/2, y:NH/2-8, 'text-anchor':'middle', 'dominant-baseline':'middle', fill:'#fff', 'font-size':'14', 'font-weight':'700', 'font-family':'Inter,sans-serif' });
    t1.textContent = node.isStart ? '▶ START' : '⬛ END';
    g.appendChild(t1);
    const t2 = mkEl('text', { x:NW/2, y:NH/2+12, 'text-anchor':'middle', fill:'rgba(255,255,255,0.8)', 'font-size':'9', 'font-family':'Inter,sans-serif' });
    t2.textContent = node.isStart ? 'Week 3 · Jan 21, 2026' : 'Week 13 · Apr 8, 2026';
    g.appendChild(t2);
    nodeGroup.appendChild(g);
    return;
  }

  g.appendChild(mkEl('rect', { x:0, y:0, width:NW, height:NH, rx:6, ry:6, fill:bgColor, stroke:borderColor, 'stroke-width': isCrit ? '2.5' : '1.5', filter:'drop-shadow(0 1px 4px rgba(0,0,0,0.1))' }));
  g.appendChild(mkEl('rect', { x:0, y:0, width:NW, height:22, rx:6, ry:6, fill:headerColor }));
  g.appendChild(mkEl('rect', { x:0, y:11, width:NW, height:11, fill:headerColor }));
  const idTxt = mkEl('text', { x:8, y:15, fill:'#fff', 'font-size':'9.5', 'font-weight':'700', 'font-family':'Inter,sans-serif' });
  idTxt.textContent = node.id;
  g.appendChild(idTxt);
  const phaseTxt = mkEl('text', { x:NW-6, y:15, fill:'rgba(255,255,255,0.75)', 'font-size':'7.5', 'text-anchor':'end', 'font-family':'Inter,sans-serif' });
  phaseTxt.textContent = phase.label;
  g.appendChild(phaseTxt);

  const words = node.name.split(' ');
  let line1 = '', line2 = '';
  words.forEach(w => { if ((line1 + ' ' + w).trim().length <= 22) line1 = (line1+' '+w).trim(); else line2 = (line2+' '+w).trim(); });
  const name1 = mkEl('text', { x:NW/2, y:34, 'text-anchor':'middle', fill:'#1A1A2E', 'font-size':'8.5', 'font-weight':'600', 'font-family':'Inter,sans-serif' });
  name1.textContent = line1;
  g.appendChild(name1);
  if (line2) { const name2 = mkEl('text', { x:NW/2, y:44, 'text-anchor':'middle', fill:'#1A1A2E', 'font-size':'8.5', 'font-weight':'600', 'font-family':'Inter,sans-serif' }); name2.textContent = line2; g.appendChild(name2); }

  const nameBottomY = line2 ? 50 : 40;
  g.appendChild(mkEl('line', { x1:0, y1:nameBottomY, x2:NW, y2:nameBottomY, stroke:'#EEF0F5', 'stroke-width':'1' }));
  const gridY = nameBottomY + 2, colW = NW / 2;

  ['ES','EF','LS','LF'].forEach((lbl, i) => {
    const col = i % 2, row = Math.floor(i / 2);
    const cx = colW * (col + 0.5), cy = gridY + row * 26;
    const lblEl = mkEl('text', { x:cx, y:cy+8, 'text-anchor':'middle', fill:'#888', 'font-size':'7', 'font-family':'Inter,sans-serif' });
    lblEl.textContent = lbl;
    g.appendChild(lblEl);
    const valEl = mkEl('text', { x:cx, y:cy+18, 'text-anchor':'middle', fill:'#1A1A2E', 'font-size':'9.5', 'font-weight':'700', 'font-family':'Inter,sans-serif' });
    valEl.textContent = 'W'+node[lbl];
    g.appendChild(valEl);
  });
  g.appendChild(mkEl('line', { x1:colW, y1:gridY, x2:colW, y2:gridY+52, stroke:'#EEF0F5', 'stroke-width':'1' }));
  g.appendChild(mkEl('line', { x1:0, y1:gridY+26, x2:NW, y2:gridY+26, stroke:'#EEF0F5', 'stroke-width':'1' }));

  const floatY = gridY + 52;
  g.appendChild(mkEl('line', { x1:0, y1:floatY, x2:NW, y2:floatY, stroke:'#EEF0F5', 'stroke-width':'1' }));
  const floatBarHeight = NH - floatY;
  g.appendChild(mkEl('rect', { x:0, y:floatY, width:NW, height:floatBarHeight, rx:6, ry:6, fill:floatBg }));
  g.appendChild(mkEl('rect', { x:0, y:floatY, width:NW, height:6, fill:floatBg }));
  const floatTextY = floatY + (floatBarHeight / 2) + 3;
  const durTxt = mkEl('text', { x:10, y:floatTextY, fill:'#555', 'font-size':'9', 'font-weight':'600', 'font-family':'Inter,sans-serif' });
  durTxt.textContent = `${node.dur} wk${node.dur!==1?'s':''}  •`;
  g.appendChild(durTxt);
  const floatTxtEl = mkEl('text', { x:NW-10, y:floatTextY, 'text-anchor':'end', fill:floatTxt, 'font-size':'9', 'font-weight':'700', 'font-family':'Inter,sans-serif' });
  floatTxtEl.textContent = floatLabel;
  g.appendChild(floatTxtEl);

  nodeGroup.appendChild(g);
});
svg.appendChild(nodeGroup);
}

// Network export functions
function toggleNetExportMenu() {
  const menu = document.getElementById('netExportMenu');
  menu.classList.toggle('show');
}

document.addEventListener('click', (e) => {
  const wrap = document.querySelector('.net-export-wrap');
  const menu = document.getElementById('netExportMenu');
  if (wrap && menu && !wrap.contains(e.target)) {
    menu.classList.remove('show');
  }
});

function netExportPNG() {
  const menu = document.getElementById('netExportMenu');
  menu.classList.remove('show');
  const svg = document.getElementById('netSvg');
  const canvas = document.createElement('canvas');
  const ctx = canvas.getContext('2d');
  const svgRect = svg.getBoundingClientRect();
  const scale = 4;
  canvas.width = svgRect.width * scale;
  canvas.height = svgRect.height * scale;
  ctx.fillStyle = '#FFFFFF';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  const svgData = new XMLSerializer().serializeToString(svg);
  const svgBlob = new Blob([svgData], { type: 'image/svg+xml;charset=utf-8' });
  const url = URL.createObjectURL(svgBlob);
  const img = new Image();
  img.onload = function() {
    ctx.scale(scale, scale);
    ctx.drawImage(img, 0, 0);
    URL.revokeObjectURL(url);
    const link = document.createElement('a');
    link.download = 'DeerghAyu_Network_Diagram.png';
    link.href = canvas.toDataURL('image/png');
    link.click();
  };
  img.src = url;
}

function netExportPDF() {
  const menu = document.getElementById('netExportMenu');
  menu.classList.remove('show');
  // Hide gantt, show network for print
  document.getElementById('gantt').style.display = 'none';
  document.getElementById('network').style.display = 'block';
  window.print();
  // Restore after print
  setTimeout(() => {
    document.getElementById('gantt').style.display = 'block';
    document.getElementById('network').style.display = 'none';
  }, 100);
}
</script>
</body>
</html>
